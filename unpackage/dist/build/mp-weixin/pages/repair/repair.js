(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/repair/repair"],{"0f4b":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o("3035"),r=i.constant,a=i.factory,n={data:function(){return{minDate:(new Date).getTime(),bindDate:"请选择",bindTime:"请选择",roomCloums:[],roomIdArr:[],roomName:"",roomId:"",roomShow:!1,typeName:"",repairType:"",typeShow:!1,timeShow:!1,imgList:[],bindTel:"",context:"",bindRepairName:"",userId:"",userName:"",storeId:"",photos:[],communityId:"",communityName:"",complaintIndex:0,index:0,repairScopes:[{id:"001",name:"小区"},{id:"002",name:"楼栋"},{id:"003",name:"单元"},{id:"004",name:"房屋"}],repairTypes:[],repairTypeIndex:0,repairScopeIndex:0,repairObjType:"",repairObjId:"",repairObjName:"",floorNum:"",floorId:"",unitNum:"",unitId:"",priceScope:""}},onLoad:function(e){var t=this;i.onLoad(e),i.getRooms().then((function(e){var o=e.data.rooms,i=[],r=[];o.map((function(e){i.push(e.floorNum+"号楼"+e.unitNum+"单元"+e.roomNum+"室"),r.push(e.roomId)})),t.roomCloums=i,t.roomIdArr=r,t.userId=e.data.owner.userId,t.userName=e.data.owner.appUserName,t.communityId=e.data.owner.communityId,t.communityName=e.data.owner.communityName})),this._loadRepairTypes()},onReady:function(){},onShow:function(){var t=e.getStorageSync("_selectFloor");null!=t&&void 0!=t&&""!=t&&(this.floorNum=t.floorNum+"栋",this.floorId=t.floorId);var o=e.getStorageSync("_selectUnit");null!=o&&void 0!=o&&""!=o&&(this.unitNum=o.unitNum+"单元",this.unitId=o.unitId)},onHide:function(){},onUnload:function(){e.removeStorageSync("_selectFloor"),e.removeStorageSync("_unitFloor")},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},methods:{formatter:function(e,t){return"year"===e?"".concat(t,"年"):"month"===e?"".concat(t,"月"):"day"===e?"".concat(t,"日"):t},submitRepair:function(e){var t={repairName:this.bindRepairName,repairType:this.repairType,appointmentTime:this.bindDate+" "+this.bindTime+":00",tel:this.bindTel,roomId:this.roomId,photos:[],context:this.context,userId:this.userId,userName:this.userName,communityId:this.communityId,bindDate:this.bindDate,bindTime:this.bindTime,repairObjType:this.repairObjType};"001"==this.repairObjType?(t.repairObjId=this.communityId,t.repairObjName=this.communityName):"002"==this.repairObjType?(t.repairObjId=this.floorId,t.repairObjName=this.floorNum):"003"==this.repairObjType?(t.repairObjId=this.unitId,t.repairObjName=this.floorNum+this.unitNum):(t.repairObjId=this.roomId,t.repairObjName=this.roomName);var o=this.photos;o.forEach((function(e){t.photos.push({photo:e})}));var a="";""==t.repairType?a="请选择报修类型":""==t.bindRepairName?a="请填写报修人":""==t.tel?a="请填写手机号":""==t.bindDate?a="请选择预约日期":""==t.bindTime?a="请选择预约时间":""==t.context?a="请填写投诉内容":""==t.repairObjId&&(a="请选择报修位置"),""!=a?wx.showToast({title:a,icon:"none",duration:2e3}):i.request({url:r.url.saveOwnerRepair,header:i.getHeaders(),method:"POST",data:t,success:function(e){var t=e.data;0!=t.code?wx.showToast({title:"服务器异常了",icon:"none",duration:2e3}):wx.redirectTo({url:"/pages/myRepair/myRepair"})},fail:function(e){wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}})},afterRead:function(e){var t=e.detail.file,o=this,i=this.photoList,r=void 0===i?[]:i;r.push(t),this.photoList=r,a.base64.urlTobase64(t.path).then((function(e){o.photos.push(e)})),console.log("data信息：",this)},deleteImage:function(e){console.log(e);var t=this.$data.imgList;t.splice(e,1)},ChooseImage:function(e){var t=this;wx.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album"],success:function(e){console.log(e),t.$data.imgList.push(e.tempFilePaths[0]);var o="";a.base64.urlTobase64(e.tempFilePaths[0]).then((function(e){o=e,console.log("base64",o),t.photos.push(o)}))}})},roomChange:function(e){this.roomId=this.roomIdArr[e.detail.value],this.roomName=this.roomCloums[e.detail.value]},repairScopeChange:function(e){console.log("改变费用完成"),this.repairScopeIndex=e.target.value;var t=this.repairScopes[this.repairScopeIndex];this.repairObjType=t.id},repairChange:function(e){this.typeName=this.columns[e.detail.value],this.typeId=this.repairIdAttr[e.detail.value]},repairTypeChange:function(e){this.repairTypeIndex=e.target.value;var t=this.repairTypes[this.repairTypeIndex];this.repairType=t.repairType;var o=t.payFeeFlag;this.priceScope="T"==o?t.priceScope:""},dateChange:function(e){this.bindDate=e.detail.value},timeChange:function(e){this.bindTime=e.detail.value},chooseFloor:function(e){console.log("点击调用了",e),i.navigateTo({url:"/pages/selectFloor/selectFloor"})},chooseUnit:function(t){null!=this.floorId&&""!=this.floorId?i.navigateTo({url:"/pages/selectUnit/selectUnit?floorId="+this.floorId}):e.showToast({title:"请先选择楼栋"})},_loadRepairTypes:function(){var t=i.getCurrentCommunity(),o=this,a={page:1,row:50,communityId:t.communityId};e.request({url:r.url.listRepairSettings,header:i.getHeaders(),method:"GET",data:a,success:function(e){var t=e.data;if(0==t.code){o.repairTypes=t.data;var i=o.repairTypes[o.repairTypeIndex];o.repairType=i.repairType;var r=i.payFeeFlag;"T"==r&&(o.priceScope=i.priceScope)}},fail:function(e){wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}})}}};t.default=n}).call(this,o("543d")["default"])},"2f26":function(e,t,o){"use strict";o.r(t);var i=o("a73c"),r=o("a419");for(var a in r)"default"!==a&&function(e){o.d(t,e,(function(){return r[e]}))}(a);o("f2cf");var n,s=o("f0c5"),u=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],n);t["default"]=u.exports},"4a31":function(e,t,o){},a419:function(e,t,o){"use strict";o.r(t);var i=o("0f4b"),r=o.n(i);for(var a in i)"default"!==a&&function(e){o.d(t,e,(function(){return i[e]}))}(a);t["default"]=r.a},a73c:function(e,t,o){"use strict";var i,r=function(){var e=this,t=e.$createElement;e._self._c},a=[];o.d(t,"b",(function(){return r})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return i}))},b725:function(e,t,o){"use strict";(function(e){o("42b7");i(o("66fd"));var t=i(o("2f26"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},f2cf:function(e,t,o){"use strict";var i=o("4a31"),r=o.n(i);r.a}},[["b725","common/runtime","common/vendor"]]]);