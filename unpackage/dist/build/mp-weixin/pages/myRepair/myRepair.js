(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myRepair/myRepair"],{"25c7":function(e,a,t){"use strict";var n=t("479d"),i=t.n(n);i.a},"479d":function(e,a,t){},7404:function(e,a,t){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=function(){t.e("components/no-data-page/no-data-page").then(function(){return resolve(t("5948"))}.bind(null,t)).catch(t.oe)},i=t("3035"),o=(i.factory,i.constant),r={data:function(){return{active:0,userId:"",roomId:"",communityId:"",waitRepair:[],doingRepair:[],repaired:[],deleteRepairModal:!1,backRepairModal:!1,curRepair:{},noData:!1,preStaffId:"",preStaffName:"",context:""}},components:{noDataPage:n},onLoad:function(e){var a=this;i.onLoad(e),i.getOwner((function(e){console.log("_ownerInfo",e),a.userId=e.userId,a.communityId=e.communityId,a._loadRepair(a.active)}))},methods:{_loadRepair:function(e){var a=this,t="",n="";t=o.url.listStaffFinishRepairs,0==e?n="1000":1==e?(t=o.url.listStaffFinishRepairs,n="1100,1200,1300"):(t=o.url.listStaffFinishRepairs,n="1400,1500,1700,1800,1900,2000");var r={communityId:a.communityId,page:1,row:10,userId:a.userId,repairStates:n};i.request({url:t,header:i.getHeaders(),method:"GET",data:r,success:function(t){var n=t.data;if(0==n.code){var i=n.data;return console.log("_ownerRepairs",i),i.length<1?a.noData=!0:a.noData=!1,void(0==e?a.waitRepair=i:1==e?a.doingRepair=i:a.repaired=i)}wx.showToast({title:"查询报修单失败",icon:"none",duration:2e3})},fail:function(e){wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}})},onChange:function(e){console.log(e),this._loadRepair(e.detail.index)},tabSelect:function(e){this.active=e,this._loadRepair(e)},repairDetail:function(e){i.navigateTo({url:"/pages/repairDetail/repairDetail?repairId="+e.repairId})},deleteRepair:function(e){this.curRepair=e,this.deleteRepairModal=!0},_cancleDeleteRepair:function(){this.deleteRepairModal=!1},_doDeleteRepair:function(){var a=this;i.request({url:o.url.deleteOwnerRepair,header:i.getHeaders(),method:"POST",data:this.curRepair,success:function(t){console.log(t),0==t.data.code?(e.showToast({icon:"none",title:"处理成功",duration:2e3}),a._cancleDeleteRepair(),a._loadRepair(0)):e.showToast({icon:"none",title:t.data.msg,duration:2e3})},fail:function(e){console.log(e),wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}})},_backRepair:function(a){var t=i.getCurrentCommunity(),n=this,r={page:1,row:1,communityId:t.communityId,repairId:a.repairId,staffId:this.userId,state:"10001"};e.request({url:o.url.listRepairStaffs,header:i.getHeaders(),method:"GET",data:r,success:function(t){var i=t.data;if(0==i.code){var o=i.data;if(o.length<1)return void e.showToast({title:"当前不能退单"});n.preStaffId=o[0].preStaffId,n.preStaffName=o[0].preStaffName,n.curRepair=a,n.backRepairModal=!0}},fail:function(e){wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}})},_cancleBackRepair:function(){this.backRepairModal=!1},_doBackRepair:function(){var a=this;if(""!=this.context){var t=i.getCurrentCommunity(),n={staffId:this.preStaffId,staffName:this.preStaffName,context:this.context,action:"BACK",repairId:this.curRepair.repairId,communityId:t.communityId};i.request({url:o.url.repairDispatch,header:i.getHeaders(),method:"POST",data:n,success:function(t){console.log(t),0==t.data.code?(e.showToast({icon:"none",title:"处理成功",duration:2e3}),a._cancleBackRepair(),a._loadRepair(0)):e.showToast({icon:"none",title:t.data.msg,duration:2e3})},fail:function(e){console.log(e),wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}})}else e.showToast({title:"退单内容不能为空",icon:"none"})},_appraiseRepair:function(e){i.navigateTo({url:"/pages/appraiseRepair/appraiseRepair?repairId="+e.repairId})},_toPay:function(e){i.navigateTo({url:"/pages/repairPay/repairPay?repairId="+e.repairId+"&communityId="+e.communityId+"&userId="+this.userId})}}};a.default=r}).call(this,t("543d")["default"])},ab7a:function(e,a,t){"use strict";t.r(a);var n=t("7404"),i=t.n(n);for(var o in n)"default"!==o&&function(e){t.d(a,e,(function(){return n[e]}))}(o);a["default"]=i.a},fa2c:function(e,a,t){"use strict";t.r(a);var n=t("fc0e"),i=t("ab7a");for(var o in i)"default"!==o&&function(e){t.d(a,e,(function(){return i[e]}))}(o);t("25c7");var r,c=t("f0c5"),u=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);a["default"]=u.exports},fb19:function(e,a,t){"use strict";(function(e){t("42b7");n(t("66fd"));var a=n(t("fa2c"));function n(e){return e&&e.__esModule?e:{default:e}}e(a.default)}).call(this,t("543d")["createPage"])},fc0e:function(e,a,t){"use strict";var n={noDataPage:function(){return t.e("components/no-data-page/no-data-page").then(t.bind(null,"5948"))}},i=function(){var e=this,a=e.$createElement;e._self._c},o=[];t.d(a,"b",(function(){return i})),t.d(a,"c",(function(){return o})),t.d(a,"a",(function(){return n}))}},[["fb19","common/runtime","common/vendor"]]]);